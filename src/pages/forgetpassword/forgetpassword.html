<ion-header>

  <ion-navbar hideBackButton>
      <ion-buttons left>
          <button ion-button (click)="this.navCtrl.pop({animation: 'ios-transition'})" padding>
              <ion-icon class="customIcon" name="arrow-back" style="zoom:1.4;"></ion-icon>
          </button>
      </ion-buttons>
      <ion-title>Forgot Password</ion-title>
   </ion-navbar>

</ion-header>
  <ion-content padding>

    <form #userForm="ngForm" (ngSubmit)="forgotpassword(userForm)" name="myForm">
      <div *ngIf="check">
          <ion-item  [class.has-error]="email1.invalid && email1.touched" [class.has-success]="email1.valid">
              <ion-label stacked><b>Email ID</b></ion-label>
              <ion-input  type="email" class="form-control" [(ngModel)]="email" name="email" pattern="([A-Za-z]|[0-9])[A-Za-z0-9.]+[A-Za-z0-9]+@[A-Za-z0-9]{2,}\[.]{1}[a-z]{2,3}" placeholder="Ex: abc@gmail.com" required #email1="ngModel"></ion-input>
            </ion-item>
            <ion-label padding-left  style="color:red" *ngIf="email1.touched && email1.pristine">Email ID is required</ion-label>
              <ion-label padding-left  style="color:red" *ngIf="email1.invalid && email1.dirty && email1.touched">Invalid Email ID</ion-label>

              <ion-label text-center>
                  <button type="button" (click)="sendOtp(userForm)" [disabled]="!email1.valid" ion-button>Send OTP</button>
              </ion-label>
              </div>
  <!-- ==================   -->

  <ion-input  hidden type="text"  [(ngModel)]="email" name="femail" #email1="ngModel"></ion-input>


  <div *ngIf="OTPCheck">

      <ion-item [class.has-error]="OTP.invalid && OTP.touched" [class.has-success]="OTP.valid">
          <ion-label stacked><b>OTP</b></ion-label>
          <ion-input type="text" class="form-control" [(ngModel)]="OTP1" name="OTP1" pattern="[0-9]{6}"  required #OTP="ngModel"></ion-input>
        </ion-item>
        <ion-label padding-left  style="color:red" *ngIf="OTP.touched && OTP.pristine">OTP is required</ion-label>
        <ion-label padding-left  style="color:red" *ngIf="OTP.invalid && OTP.dirty && OTP.touched">Invalid OTP</ion-label>


        <ion-label text-center>
            <button type="button" (click)="verifyOTP(userForm)"  [disabled]="!OTP.valid" ion-button>Verify OTP</button>
        </ion-label>
  </div>
  <!-- =============== -->
  <div *ngIf="changepassword">



      <ion-item  [class.has-error]="pwd22.invalid && pwd22.touched" [class.has-success]="pwd22.valid">
        <ion-label stacked><b>Type your New Password</b></ion-label>
        <ion-input type="{{type}}" clearOnEdit="false" class="form-control" [(ngModel)]="pwd2" name="pwd2"  pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@*#$%^&()])[A-Za-z0-9!@#$*%^&()]{8,14}"  required #pwd22="ngModel"></ion-input>

        <button padding-top ion-button clear color="primary" style="zoom:1.3;" type="button" item-right *ngIf="show" (click)="myFunction()"><ion-icon  name="md-eye-off"></ion-icon></button>
        <button padding-top ion-button clear color="primary" type="button" style="zoom:1.3;" item-right *ngIf="!show" (click)="myFunction()"><ion-icon  name="md-eye"></ion-icon></button>
      </ion-item>
      <ion-label padding-left  style="color:red" *ngIf="pwd22.pristine && pwd22.touched">New Password is required</ion-label>
      <ion-label padding-left  style="color:red" text-wrap text-justify *ngIf="pwd22.invalid && pwd22.dirty && pwd22.touched">Must be combination of atleast one uppercase,one lowercase, one digit and one special character</ion-label>


      <ion-item  [class.has-error]="pwd.invalid && pwd.touched" [class.has-success]="pwd.valid">
        <ion-label stacked><b>Re-Type New Password</b></ion-label>
        <ion-input type="{{type1}}" clearOnEdit="false" class="form-control"  pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@*#$%^&()])[A-Za-z0-9!@#$*%^&()]{8,14}"  [(ngModel)]="pwd3" name="pwd3" required #pwd="ngModel"></ion-input>

        <button padding-top ion-button clear color="primary" style="zoom:1.3;" type="button" item-right *ngIf="show1" (click)="myFunction1()"><ion-icon  name="md-eye-off"></ion-icon></button>
        <button padding-top ion-button clear color="primary" type="button" style="zoom:1.3;" item-right *ngIf="!show1" (click)="myFunction1()"><ion-icon  name="md-eye"></ion-icon></button>
      </ion-item>
      <ion-label padding-left  style="color:red" *ngIf="pwd.pristine && pwd.touched">Re-Type password is required</ion-label>
      <ion-label padding-left  style="color:red" *ngIf="!(userForm.value.pwd2==userForm.value.pwd3) && pwd.dirty && pwd.touched">Password mismatch</ion-label>



          <ion-grid>
              <ion-row>
                <ion-col><ion-label text-right><button type="submit" [disabled]="!userForm.valid || !(userForm.value.pwd2==userForm.value.pwd3)" ion-button>Change</button></ion-label></ion-col>
                <ion-col><ion-label text-left><button type="button" (click)="cancelbut()" ion-button>Cancel</button></ion-label></ion-col>
              </ion-row>
              </ion-grid>


  </div>
  </form>
  </ion-content>
